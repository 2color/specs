import TerminalApp from '../../components/TerminalApp'
import {
  multiSelectItemComponent,
  multiSelectIndicatorComponent,
  multiSelectCheckboxComponent,
  selectInputItemComponent,
  selectInputIndicatorComponent,
  Divider,
} from '../../components/inkHelpers'
import MultiSelect from 'ink-multi-select'
import SelectInput from 'ink-select-input'
import TextInput from 'ink-text-input'
// import ProgressBar from 'ink-progress-bar'
import { Box, Text, Color } from 'ink'
import figures from 'figures'

import { Terminal, Title, Spacer, Select, Option, Button, Line, Checkbox, Success, TextInput as MockTextInput, Introspection, Command } from '../../components/cli'

# SQLite - Introspection

---

### 2 File path

Previous selections:

1. SQLite
2. Use existing SQLite file

<TerminalApp>
  <Box flexDirection="column">
    <Text bold>Enter the path to your SQLite database file</Text>
    <Color>Prisma will introspect the database to generate your initial data model</Color>
  </Box>
  <Divider />
  <Box marginLeft={2} paddingTop={1} paddingBottom={1}>
    <Box marginRight={1}>File path:</Box>
    <TextInput value="" placeholder="./my.db" />
  </Box>
  <Divider />
  <Box>
    <Color gray>{figures.pointer} </Color>
    <Text bold>Introspect</Text>
  </Box>
  <Box>
    <Color gray>❮ </Color>
    <Text bold>Back</Text>
    <Color gray> (Database options)</Color>
  </Box>
</TerminalApp>

In this view, it would be great if the trailing `.db` could somehow be fixed since every SQLite DB file has the file extension.

### 2.1 Introspection

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_

<Terminal>
  $ prisma2 init hello-world
  <Spacer height={20} />
  <Introspection progress={26.5}>Introspecting SQLite database file at <b>./my.db</b> ...</Introspection>
</Terminal>

### 2.2 Tool selection

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_

<TerminalApp>
  <Box flexDirection="column" marginTop={1}>
    <Text bold>Select the Prisma tool(s) you want to use</Text>
    <Color white>Use the <Text bold>SPACE</Text> key to select/unselect a tool</Color>
  </Box>
  <Divider />
  <Box paddingBottom={1} paddingTop={1}>
    <Box width={15}>
      <MultiSelect
        focus={false}
        items={[
          { label: 'Photon', value: 'photon' },
          { label: 'Lift', value: 'lift' },
        ]}
        itemComponent={multiSelectItemComponent}
        indicatorComponent={multiSelectIndicatorComponent}
        checkboxComponent={multiSelectCheckboxComponent} />
    </Box>
    <Box flexDirection="column">
      <Color gray>Type-safe database client</Color>
      <Color gray>Declarative data modeling & migrations</Color>
    </Box>
  </Box>
  <Box marginBottom={1}>
    <Color gray>Learn more about the tools at: <Text underline>github.com/prisma/prisma2</Text></Color>
  </Box>
  <Divider />
  <Box>
    <Color gray>{figures.pointer} </Color>
    <Text bold>Confirm</Text>
  </Box>
  <Box>
    <Color gray>❮ </Color>
    <Text bold>Back</Text>
    <Color gray> (Database file path)</Color>
  </Box>
</TerminalApp>

In this view, Photon and Lift should be checked by default.

### 3.1 Language selection

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_
5. Photon

<TerminalApp>
  <Box marginTop={1}>
    <Text bold>Select the programming language to access your database with Photon</Text>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <SelectInput
      items={[
        { label: 'JavaScript', value: 'javascript' },
        { label: 'TypeScript', value: 'typescript' }
      ]}
      itemComponent={selectInputItemComponent}
      indicatorComponent={selectInputIndicatorComponent} />
    <Box marginLeft={2}>Go <Color gray>(Coming soon)</Color></Box>
  </Box>
  <Divider />
  <Box>
    <Color gray>❮ </Color>
    <Text bold>Back</Text>
    <Color gray> (Database file path)</Color>
  </Box>
</TerminalApp>

<br/>

### 4.1 Boilerplate selection

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_
5. Photon
6. JavaScript/TypeScript

<TerminalApp>
  <Box marginTop={1}>
    <Text bold>Select a boilerplate or start with just the Prisma schema</Text>
  </Box>
  <Divider />
  <Box paddingBottom={1} paddingTop={1}>
    <Box width={25}>
      <SelectInput
        items={[
          { label: 'Basic boilerplate', value: 'basic' }
        ]}
        itemComponent={selectInputItemComponent}
        indicatorComponent={selectInputIndicatorComponent} />
    </Box>
    <Box flexDirection="column">
      <Color gray>Simple script with API examples</Color>
    </Box>
  </Box>
  <Divider />
  <Box>
    <Color gray>{figures.pointer} </Color>
    <Text bold>No boilerplate</Text>
    <Color gray> (Just generate the Prisma schema)</Color>
  </Box>
  <Box>
    <Color gray>❮ </Color>
    <Text bold>Back</Text>
    <Color gray> (Language selection)</Color>
  </Box>
</TerminalApp>

### 5.1 Success

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_
5. Photon
6. JavaScript/TypeScript
7. Basic boilerplate

<TerminalApp>
  <Color greenBright>
    {figures.tick} Introspection was successful
  </Color>
  <Box flexDirection="column" marginTop={1}>
    <Color><Text bold>Result:</Text> 11 tables have been found in your SQLite database file</Color>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <Text>prisma/schema.prisma</Text>
    <Text>src/index.ts</Text>
    <Text>package.json</Text>
    <Text>node_modules/</Text>
  </Box>
  <Box flexDirection="column" marginTop={1}>
    <Text bold>What next?</Text>
    <Color gray>Run the following commands to continue</Color>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <Box>
      <Color gray>$ </Color>
      <Text>cd hello-world</Text>
    </Box>
    <Box>
      <Color gray>$ </Color>
      <Text>yarn start</Text>
    </Box>
  </Box>
  <Box marginTop={1}>
    <Text bold>To evolve your application you need to</Text>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingTop={1} paddingBottom={1}>
    <Text>1. Migrate your database</Text>
    <Text>2. Re-introspect your database to update the data model: </Text>
    <Box marginLeft={3}>
      <Color gray>$ </Color>
      <Text>prisma2 introspect</Text>
    </Box>
    <Text>2. Re-generate Photon with: </Text>
    <Box marginLeft={3}>
      <Color gray>$ </Color>
      <Text>prisma2 introspect</Text>
    </Box>
  </Box>

  <Box marginBottom={1}>This starts Prisma's development mode which automatically migrates your database and regenerates Photon when you save changes to your data model in prisma/schema.prisma.</Box>
  <Color gray>Learn more: <Text underline>prisma.io/docs/</Text></Color>
</TerminalApp>

### 3.2 Language selection

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_
5. Photon + Lift

<TerminalApp>
  <Box flexDirection="column" marginTop={1}>
    <Text bold>Select the programming language to access your database with Photon</Text>
    <Text>This decision doesn't impact the usage of Lift in your project</Text>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <SelectInput
      items={[
        { label: 'JavaScript', value: 'javascript' },
        { label: 'TypeScript', value: 'typescript' }
      ]}
      itemComponent={selectInputItemComponent}
      indicatorComponent={selectInputIndicatorComponent} />
    <Box marginLeft={2}>Go <Color gray>(Coming soon)</Color></Box>
  </Box>
  <Divider />
  <Box>
    <Color gray>❮ </Color>
    <Text bold>Back</Text>
    <Color gray> (Database file path)</Color>
  </Box>
</TerminalApp>

<br/>

### 4.2 Boilerplate selection

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_
5. Photon + Lift
6. JavaScript/TypeScript

<TerminalApp>
  <Box marginTop={1}>
    <Text bold>Select a boilerplate or start with just the Prisma schema</Text>
  </Box>
  <Divider />
  <Box paddingBottom={1} paddingTop={1}>
    <Box width={25}>
      <SelectInput
        items={[
          { label: 'Basic boilerplate', value: 'basic' }
        ]}
        itemComponent={selectInputItemComponent}
        indicatorComponent={selectInputIndicatorComponent} />
    </Box>
    <Box flexDirection="column">
      <Color gray>Simple script with API examples</Color>
    </Box>
  </Box>
  <Divider />
  <Box>
    <Color gray>{figures.pointer} </Color>
    <Text bold>No boilerplate</Text>
    <Color gray> (Just generate the Prisma schema)</Color>
  </Box>
  <Box>
    <Color gray>❮ </Color>
    <Text bold>Back</Text>
    <Color gray> (Language selection)</Color>
  </Box>
</TerminalApp>


### 5.2 Success

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_
5. Photon + Lift
6. JavaScript/TypeScript
7. Basic boilerplate

<TerminalApp>
  <Color greenBright>{figures.tick} Introspection was successful</Color>
  <Text>Result: 11 tables have been found in your SQLite database file</Text>
  <Box flexDirection="column" marginTop={1}>
    <Text bold>What files were created?</Text>
    <Color gray>The following files have been created inside the hello-world directory:</Color>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <Text>prisma/schema.prisma</Text>
    <Text>src/index.ts</Text>
    <Text>tsconfig.json</Text>
    <Text>package.json</Text>
    <Text>node_modules/</Text>
    <Box marginTop={1}><Color gray>Note that src/index.ts contains sample read operations of the Photon API.</Color></Box>
  </Box>
  <Box flexDirection="column" marginTop={1}>
    <Text bold>What next?</Text>
    <Color gray>Run the following commands to continue</Color>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <Box>
      <Color gray>$ </Color>
      <Text>cd hello-world</Text>
    </Box>
    <Box>
      <Color gray>$ </Color>
      <Text>yarn start</Text>
    </Box>
  </Box>
  <Box marginBottom={1}>This invokes the script at src/index.ts which performs some sample read operations against your database and prints the results to the terminal.</Box>
  <Box flexDirection="column" marginBottom={1} marginTop={1}>
    <Text bold>To evolve your application, run:</Text>
    <Divider />
  </Box>
  <Box marginBottom={1}>
    <Color gray>$ </Color>
    <Text>prisma dev</Text>
  </Box>
  <Box marginBottom={1}>This starts Prisma's development mode which automatically migrates your database and regenerates Photon when you save changes to your data model in prisma/schema.prisma.</Box>
  <Color gray>Learn more: <Text underline>prisma.io/docs/</Text></Color>
</TerminalApp>



### 5.3 Success

Previous selections:

1. SQLite
2. Use existing SQLite file
3. _entered file path_
4. _introspected DB_
5. Lift

<TerminalApp>
  <Color greenBright>{figures.tick} Introspection was successful</Color>
  <Text>Result: 11 tables have been found in your SQLite database file</Text>
  <Box flexDirection="column" marginTop={1}>
    <Text bold>What files were created?</Text>
    <Color gray>The following files have been created inside the hello-world directory:</Color>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <Text>schema.prisma</Text>
  </Box>
  <Box flexDirection="column" marginTop={1}>
    <Text bold>What next?</Text>
    <Color gray>Run the following commands to continue</Color>
  </Box>
  <Divider />
  <Box flexDirection="column" paddingBottom={1} paddingTop={1}>
    <Box>
      <Color gray>$ </Color>
      <Text>cd hello-world</Text>
    </Box>
    <Box>
      <Color gray>$ </Color>
      <Text>prisma dev</Text>
    </Box>
  </Box>
  <Box marginBottom={1}>This starts Prisma's development mode which automatically migrates your database when you save changes to your data model in hello-world/schema.prisma</Box>
  <Color gray>Learn more: <Text underline>prisma.io/docs/</Text></Color>
</TerminalApp>